<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: OrganizationBoards.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: OrganizationBoards.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { useEffect, useState } from "react";
import {
  View,
  Text,
  StyleSheet,
  ScrollView,
  TouchableOpacity,
  Modal,
  TextInput,
  Button,
} from "react-native";
import axios from "axios";
import { API_KEY, TOKEN } from "@env";
import { useNavigation } from "@react-navigation/native";
import { RectButton, Swipeable } from "react-native-gesture-handler";


const OrganizationBoardsScreen = ({ route }) => {
  // state
  const { boardId } = route.params;  // [FEAT]: get organizationId from route.params
  const { organizationId } = route.params;
  const [boards, setBoards] = useState([]);
  const [isModalVisible, setIsModalVisible] = useState(false);
  const [newBoardName, setNewBoardName] = useState("");
  const [isDeleteModalVisible, setIsDeleteModalVisible] = useState(false);
  const [selectedBoardForDelete, setSelectedBoardForDelete] = useState(null);

  const navigation = useNavigation();

/**
 * Récupère les tableaux d'une organisation spécifique à partir de l'API Trello.
 * @async
 * @function fetchBoards
 * @throws {Error} Si une erreur se produit lors de la récupération des tableaux.
 */
  const fetchBoards = async () => {
    try {
      const response = await axios.get(
        `https://api.trello.com/1/organizations/${organizationId}/boards?key=${API_KEY}&amp;token=${TOKEN}`
      );
      setBoards(response.data);
    } catch (error) {
      console.error("Error fetching boards:", error);
    }
  };

 
  /**
   * [FEAT]: create a board
  * Crée un nouveau tableau dans l'organisation à partir de l'API Trello.
  * @async
  * @function createBoard
  * @throws {Error} Si une erreur se produit lors de la création du tableau.
  */
  const createBoard = async () => {
    if (newBoardName.trim()) {
      try {
        const response = await axios.post(
          `https://api.trello.com/1/boards/?name=${encodeURIComponent(
            newBoardName
          )}&amp;key=${API_KEY}&amp;token=${TOKEN}`
        );
        if (response.data) {
          setBoards([...boards, response.data]);
          setIsModalVisible(false);
        }
      } catch (error) {
        console.error("Error creating board: ", error);
      }
    } else {
      alert("Please enter a board name.");
    }
  };

  //[FEAT]: delete a board
  /**
 * Supprime un tableau spécifique de l'organisation à partir de l'API Trello.
 * @async
 * @function confirmDeleteBoard
 * @param {string} boardId - L'ID du tableau à supprimer.
 * @throws {Error} Si une erreur se produit lors de la suppression du tableau.
 */
  const confirmDeleteBoard = async (boardId) => {
    try {
      const response = await axios.delete(
        `https://api.trello.com/1/boards/${boardId}?key=${API_KEY}&amp;token=${TOKEN}`
      );
      if (response.status === 200) {
        setBoards(
          boards.filter((brd) => brd.id !== boardId)
        );
        setIsDeleteModalVisible(false);
      }
    } catch (error) {
      console.error("Error deleting board: ", error);
    }
  };

  /**
 * Rend les actions de droite pour un tableau spécifique.
 * @function renderRightActions
 * @param {object} progress - L'objet de progression de l'animation.
 * @param {object} dragX - L'objet de la position de glissement en X.
 * @param {object} board - L'objet du tableau.
 * @returns {ReactNode} Le noeud React à rendre.
 */
  const renderRightActions = (progress, dragX, board) => {
    return (
      &lt;RectButton
        style={[styles.actionButton, styles.deleteButton]}
        onPress={() => {
          setSelectedBoardForDelete(board.id);
          setIsDeleteModalVisible(true);
        }}
      >
        &lt;Text style={styles.actionButtonText}>Del&lt;/Text>
      &lt;/RectButton>
    );
  };

  // Actualise l'affichage des tableaux de l'organisation lorsqu'elle change.
  useEffect(() => {
    fetchBoards();
  }, [organizationId]);



  //[RETURN]: render the organization boards
  return (
    &lt;ScrollView style={styles.container}>
      
      &lt;TouchableOpacity
        style={styles.button}
        onPress={() => setIsModalVisible(true)}
      >
        &lt;Text style={styles.buttonText}>Create Board&lt;/Text>
      &lt;/TouchableOpacity> 

      {boards.map((board, index) => (

        &lt;Swipeable
        key={board.id}
        renderRightActions={(progress, dragX) =>
          renderRightActions(progress, dragX, board)
        }
      >
        &lt;TouchableOpacity
          key={index}
          style={styles.card}
          onPress={() =>
            navigation.navigate("BoardLists", { boardId: board.id })
          }
        >
          &lt;Text style={styles.cardTitle}>{board.name}&lt;/Text>
        &lt;/TouchableOpacity>
        &lt;/Swipeable>
      ))}
      
      &lt;Modal
        animationType="slide"
        transparent={true}
        visible={isModalVisible}
        onRequestClose={() => setIsModalVisible(false)}
      >
        &lt;View style={styles.modalView}>
          &lt;TextInput
            style={styles.input}

            placeholder="New Workspace Name"

            value={newBoardName}
            onChangeText={setNewBoardName}
          />
          &lt;Button title="Create Board" onPress={createBoard} />
          &lt;Button title="Cancel" onPress={() => setIsModalVisible(false)} />
        &lt;/View>
      &lt;/Modal>

      &lt;Modal
        animationType="slide"
        transparent={true}
        visible={isDeleteModalVisible}
        onRequestClose={() => setIsDeleteModalVisible(false)}
      >
        &lt;View style={styles.modalView}>
          &lt;Text>Are you sure you want to delete this Board?&lt;/Text>
          &lt;TouchableOpacity
            style={[styles.button, styles.buttonClose]}
            onPress={() => {
              if (selectedBoardForDelete)
                confirmDeleteBoard(selectedBoardForDelete);
            }}
          >
            &lt;Text style={styles.textStyle}>Delete&lt;/Text>
          &lt;/TouchableOpacity>
          &lt;TouchableOpacity
            style={[styles.button, styles.buttonClose]}
            onPress={() => setIsDeleteModalVisible(false)}
          >
            &lt;Text style={styles.textStyle}>Cancel&lt;/Text>
          &lt;/TouchableOpacity>
        &lt;/View>
      &lt;/Modal>
    
    &lt;/ScrollView>
  );
};








// [CSS]: styling

const styles = StyleSheet.create({
  container: {
    flex: 1,
    padding: 10,
  },
  card: {
    backgroundColor: "#FFFFFF",
    borderRadius: 8,
    padding: 20,
    marginBottom: 10,
    shadowColor: "#000",
    shadowOffset: {
      width: 0,
      height: 2,
    },
    shadowOpacity: 0.25,
    shadowRadius: 3.84,
    elevation: 5,
  },
  cardTitle: {
    fontSize: 18,
    fontWeight: "bold",
  },
  button: {
    backgroundColor: "#007AFF",
    padding: 10,
    borderRadius: 5,
    alignItems: "center",
    marginBottom: 20,
  },
  buttonText: {
    color: "#fff",
    fontSize: 18,
    fontWeight: "bold",
  },
  modalView: {
    marginTop: 150,
    marginHorizontal: 50,
    backgroundColor: "white",
    borderRadius: 5,
    padding: 35,
    alignItems: "center",
    shadowColor: "#000",
    shadowOffset: {
      width: 0,
      height: 2,
    },
    shadowOpacity: 0.25,
    shadowRadius: 3.84,
    elevation: 5,
  },
  input: {
    height: 40,
    borderColor: "gray",
    borderWidth: 1,
    marginBottom: 20,
    width: "100%",
    padding: 10,
  },
  actionButton: {
    justifyContent: "center",
    alignItems: "center",
    width: 80,
    padding: 15,
  },
  editButton: {
    backgroundColor: "orange",
  },
  deleteButton: {
    backgroundColor: "red",
  },
  actionButtonText: {
    color: "white",
    fontSize: 16,
  },
});

export default OrganizationBoardsScreen;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#confirmDeleteBoard">confirmDeleteBoard</a></li><li><a href="global.html#createBoard">createBoard</a></li><li><a href="global.html#fetchBoards">fetchBoards</a></li><li><a href="global.html#renderRightActions">renderRightActions</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Mon Mar 18 2024 06:40:00 GMT+0100 (heure normale d’Europe centrale)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
